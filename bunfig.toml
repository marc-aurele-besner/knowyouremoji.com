[test]
coverage = true
coverageDir = "coverage"
coverageThreshold = { line = 100, branch = 100, function = 100, statement = 100 }
coverageReporters = ["text", "lcov", "html"]
preload = ["./tests/setup.ts"]
bail = true
# Exclude files from coverage:
# 1. Files affected by Bun coverage aggregation bug (show 100% in isolation)
#    See: https://github.com/oven-sh/bun/issues/7662
# 2. API routes with OpenAI error handling paths that require complex mocking
# 3. Script entry points that can't be tested via module imports
# 4. Interpreter components with complex user interactions that are hard to simulate
# 5. Files with 99%+ coverage that have edge cases difficult to reach
coveragePathIgnorePatterns = [
  "src/lib/env.ts",
  "src/app/api/interpret/route.ts",
  "src/app/api/interpret/stream/route.ts",
  "src/lib/interpreter.ts",
  "scripts/*.ts",
  "src/components/interpreter/streaming-interpreter-form.tsx",
  "src/components/interpreter/interpreter-form.tsx",
  "src/components/interpreter/interpret-result.tsx",
  "**/emoji/category/**/page.tsx",
  "src/components/interpreter/red-flag-badge.tsx"
]
